(this["webpackJsonpmesto-react"]=this["webpackJsonpmesto-react"]||[]).push([[0],{17:function(e,t,n){},18:function(e,t,n){"use strict";n.r(t);var a=n(0),c=n(1),s=n.n(c),r=n(8),o=n.n(r),i=(n(17),n(10)),u=n(2),l=n.p+"static/media/logo.a307e1c4.svg";var d=function(){return Object(a.jsx)("header",{className:"header",children:Object(a.jsx)("img",{src:l,alt:"\u041b\u043e\u0433\u043e\u0442\u0438\u043f \u0441\u0435\u0440\u0432\u0438\u0441\u0430 \u041c\u0435\u0441\u0442\u043e",className:"header__logo"})})};var m=function(){return Object(a.jsx)("footer",{className:"footer",children:Object(a.jsx)("p",{className:"footer__copyright",children:"\xa9 2020 Mesto Russia"})})},f=n.p+"static/media/editAvatarButton.a086f758.svg",p=s.a.createContext();var h=function(e){var t=s.a.useContext(p),n=e.card.likes.some((function(e){return e._id===t._id})),c="element__like-button ".concat(n?"element__like-button_liked":"");return Object(a.jsxs)("div",{className:"element",children:[Object(a.jsx)("img",{className:"element__image",src:e.card.link,onClick:function(){e.onCardClick(e.card)},alt:"\u041d\u0430 \u0444\u043e\u0442\u043e\u0433\u0440\u0430\u0444\u0438\u0438: ".concat(e.card.name)}),Object(a.jsx)("button",{className:"element__delete-button ".concat(e.card.owner._id!==t._id?"element__delete-button_hidden":""),type:"button","aria-label":"\u0423\u0434\u0430\u043b\u0438\u0442\u044c",onClick:function(){e.onCardDelete(e.card)}}),Object(a.jsxs)("div",{className:"element__title-item",children:[Object(a.jsx)("h2",{className:"element__title",children:e.card.name}),Object(a.jsxs)("div",{className:"element__like",children:[Object(a.jsx)("button",{className:c,onClick:function(){e.onCardLike(e.card)},type:"button","aria-label":"\u041d\u0440\u0430\u0432\u0438\u0442\u0441\u044f"}),Object(a.jsx)("p",{className:"element__like-count",children:e.card.likes.length})]})]})]})};var j=function(e){var t=s.a.useContext(p);return Object(a.jsxs)("main",{className:"content",children:[Object(a.jsxs)("section",{className:"profile",children:[Object(a.jsx)("div",{className:"profile__avatar-container",style:{backgroundImage:"url(".concat(f,")")},children:Object(a.jsx)("img",{alt:"\u041b\u043e\u0433\u043e\u0442\u0438\u043f \u043f\u0440\u043e\u0444\u0438\u043b\u044f",className:"profile__avatar",src:t.avatar,onClick:e.onEditAvatar})}),Object(a.jsxs)("div",{className:"profile__profile-info",children:[Object(a.jsxs)("div",{className:"profile__title-item",children:[Object(a.jsx)("h1",{className:"profile__title",children:t.name}),Object(a.jsx)("button",{className:"profile__edit-button",type:"button","aria-label":"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u043e\u0444\u0438\u043b\u044c",onClick:e.onEditProfile})]}),Object(a.jsx)("p",{className:"profile__subtitle",children:t.about})]}),Object(a.jsx)("button",{className:"profile__add-button",type:"button","aria-label":"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c",onClick:e.onAddPlace})]}),Object(a.jsx)("section",{className:"elements",children:e.cards.map((function(t){return Object(a.jsx)(h,{card:t,onCardClick:e.onCardClick,onCardLike:e.onCardLike,onCardDelete:e.onCardDelete},t._id)}))})]})},_=n(5),b=n(6),O=n(11),x=n(9),v=function(e){Object(O.a)(n,e);var t=Object(x.a)(n);function n(){return Object(_.a)(this,n),t.apply(this,arguments)}return Object(b.a)(n,[{key:"render",value:function(){return Object(a.jsx)("div",{className:"popup popup_theme_".concat(this.props.name," ").concat(this.props.isOpen?"popup_opened":""),onClick:this.props.onClose,children:Object(a.jsxs)("div",{className:"popup__container popup__container_theme_".concat(this.props.name),children:[Object(a.jsx)("button",{className:"popup__close-button",type:"button","aria-label":"\u0417\u0430\u043a\u0440\u044b\u0442\u044c"}),Object(a.jsxs)("form",{className:"form form_type_".concat(this.props.name),name:this.props.name,onSubmit:this.props.onSubmit,noValidate:!0,children:[Object(a.jsx)("h2",{className:"form__title",children:this.props.title}),this.props.children,Object(a.jsx)("button",{type:"submit",className:"form__submit-button",children:this.props.submitText})]})]})})}}]),n}(s.a.Component);function k(e){var t=s.a.useState(""),n=Object(u.a)(t,2),c=n[0],r=n[1],o=s.a.useState(""),i=Object(u.a)(o,2),l=i[0],d=i[1],m=s.a.useContext(p);return s.a.useEffect((function(){r(m.name),d(m.about)}),[m]),s.a.useEffect((function(){e.isOpen||(r(m.name),d(m.about))}),[e.isOpen,m]),Object(a.jsxs)(v,{name:"edit-profile",title:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u043e\u0444\u0438\u043b\u044c",submitText:e.submitText,isOpen:e.isOpen,onClose:e.onClose,onSubmit:function(t){t.preventDefault(),e.onUpdateUser({name:c,about:l})},children:[Object(a.jsx)("input",{type:"text",name:"userName",onChange:function(e){r(e.target.value)},placeholder:"\u0418\u043c\u044f",className:"form__item form__item_el_name",id:"userName",maxLength:"40",minLength:"2",value:c||"",required:!0}),Object(a.jsx)("span",{className:"form__item-error",id:"userName-error"}),Object(a.jsx)("input",{type:"text",name:"userJob",onChange:function(e){d(e.target.value)},placeholder:"\u041e \u0441\u0435\u0431\u0435",className:"form__item form__item_el_position",id:"userJob",minLength:"2",maxLength:"200",value:l||"",required:!0}),Object(a.jsx)("span",{className:"form__item-error",id:"userJob-error"})]})}function C(e){var t=s.a.useRef();return s.a.useEffect((function(){e.isOpen&&(t.current.value="")}),[e.isOpen]),Object(a.jsxs)(v,{name:"edit-avatar",title:"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0430\u0432\u0430\u0442\u0430\u0440",submitText:e.submitText,isOpen:e.isOpen,onClose:e.onClose,onSubmit:function(n){n.preventDefault(),e.onUpdateAvatar({avatar:t.current.value})},children:[Object(a.jsx)("input",{type:"url",name:"avatarLink",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u0430\u0432\u0430\u0442\u0430\u0440\u043a\u0443",className:"form__item form__item_el_link-avatar",id:"avatarLink",ref:t,required:!0}),Object(a.jsx)("span",{className:"form__item-error",id:"avatarLink-error"})]})}function g(e){var t=s.a.useState(""),n=Object(u.a)(t,2),c=n[0],r=n[1],o=s.a.useState(""),i=Object(u.a)(o,2),l=i[0],d=i[1];return s.a.useEffect((function(){e.isOpen||(r(""),d(""))}),[e.isOpen]),Object(a.jsxs)(v,{name:"add-card",title:"\u041d\u043e\u0432\u043e\u0435 \u043c\u0435\u0441\u0442\u043e",submitText:e.submitText,isOpen:e.isOpen,onClose:e.onClose,onSubmit:function(t){t.preventDefault(),e.onAddNewCard({link:l,name:c})},children:[Object(a.jsx)("input",{type:"text",name:"name",placeholder:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u043c\u0435\u0441\u0442\u0430",className:"form__item form__item_el_title",id:"cardTitle",minLength:"2",maxLength:"30",onChange:function(e){r(e.target.value)},value:c,required:!0}),Object(a.jsx)("span",{className:"form__item-error",id:"cardTitle-error"}),Object(a.jsx)("input",{type:"url",name:"link",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",className:"form__item form__item_el_link",id:"cardLink",onChange:function(e){d(e.target.value)},value:l,required:!0}),Object(a.jsx)("span",{className:"form__item-error",id:"cardLink-error"})]})}var N=function(e){return Object(a.jsx)("div",{className:"popup popup_theme_preview-image ".concat(e.card.isOpen?"popup_opened":""),onClick:e.onClose,children:Object(a.jsxs)("div",{className:"popup__container popup__container_theme_preview-image",children:[Object(a.jsx)("button",{className:"popup__close-button",type:"button","aria-label":"\u0417\u0430\u043a\u0440\u044b\u0442\u044c"}),Object(a.jsxs)("figure",{className:"popup__figure",children:[Object(a.jsx)("img",{className:"popup__image",src:e.card.cardImage,alt:"\u041d\u0430 \u0444\u043e\u0442\u043e\u0433\u0440\u0430\u0444\u0438\u0438: ".concat(e.card.cardTitle)}),Object(a.jsx)("figcaption",{className:"popup__capture",children:e.card.cardTitle})]})]})})},y=new(function(){function e(t){var n=t.url,a=t.headers;Object(_.a)(this,e),this._headers=a,this._url=n}return Object(b.a)(e,[{key:"getInitialCards",value:function(){return fetch("".concat(this._url,"/cards"),{headers:this._headers}).then((function(e){return e.ok?e.json():Promise.reject("\u0427\u0442\u043e-\u0442\u043e \u043f\u043e\u0448\u043b\u043e \u043d\u0435 \u0442\u0430\u043a: ".concat(e.status))}))}},{key:"getUserInfo",value:function(){return fetch("".concat(this._url,"/users/me"),{headers:this._headers}).then((function(e){return e.ok?e.json():Promise.reject("\u0427\u0442\u043e-\u0442\u043e \u043f\u043e\u0448\u043b\u043e \u043d\u0435 \u0442\u0430\u043a: ".concat(e.status))}))}},{key:"setUserInfo",value:function(e){var t=e.name,n=e.about;return fetch("".concat(this._url,"/users/me"),{method:"PATCH",headers:this._headers,body:JSON.stringify({name:t,about:n})}).then((function(e){return e.ok?e.json():Promise.reject("\u0427\u0442\u043e-\u0442\u043e \u043f\u043e\u0448\u043b\u043e \u043d\u0435 \u0442\u0430\u043a: ".concat(e.status))}))}},{key:"setUserAvatar",value:function(e){var t=e.avatar;return fetch("".concat(this._url,"/users/me/avatar"),{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:t})}).then((function(e){return e.ok?e.json():Promise.reject("\u0427\u0442\u043e-\u0442\u043e \u043f\u043e\u0448\u043b\u043e \u043d\u0435 \u0442\u0430\u043a: ".concat(e.status))}))}},{key:"addNewCard",value:function(e){var t=e.link,n=e.name;return fetch("".concat(this._url,"/cards"),{method:"POST",headers:this._headers,body:JSON.stringify({name:n,link:t})}).then((function(e){return e.ok?e.json():Promise.reject("\u0427\u0442\u043e-\u0442\u043e \u043f\u043e\u0448\u043b\u043e \u043d\u0435 \u0442\u0430\u043a: ".concat(e.status))}))}},{key:"deleteCard",value:function(e){return fetch("".concat(this._url,"/cards/").concat(e),{method:"DELETE",headers:this._headers}).then((function(e){return e.ok?e.json():Promise.reject("\u0427\u0442\u043e-\u0442\u043e \u043f\u043e\u0448\u043b\u043e \u043d\u0435 \u0442\u0430\u043a: ".concat(e.status))}))}},{key:"changeLikeCardStatus",value:function(e,t){return t?fetch("".concat(this._url,"/cards/likes/").concat(e),{method:"DELETE",headers:this._headers}).then((function(e){return e.ok?e.json():Promise.reject("\u0427\u0442\u043e-\u0442\u043e \u043f\u043e\u0448\u043b\u043e \u043d\u0435 \u0442\u0430\u043a: ".concat(e.status))})):fetch("".concat(this._url,"/cards/likes/").concat(e),{method:"PUT",headers:this._headers}).then((function(e){return e.ok?e.json():Promise.reject("\u0427\u0442\u043e-\u0442\u043e \u043f\u043e\u0448\u043b\u043e \u043d\u0435 \u0442\u0430\u043a: ".concat(e.status))}))}},{key:"setLike",value:function(e){return fetch("".concat(this._url,"/cards/likes/").concat(e),{method:"PUT",headers:this._headers}).then((function(e){return e.ok?e.json():Promise.reject("\u0427\u0442\u043e-\u0442\u043e \u043f\u043e\u0448\u043b\u043e \u043d\u0435 \u0442\u0430\u043a: ".concat(e.status))}))}},{key:"deleteLike",value:function(e){return fetch("".concat(this._url,"/cards/likes/").concat(e),{method:"DELETE",headers:this._headers}).then((function(e){return e.ok?e.json():Promise.reject("\u0427\u0442\u043e-\u0442\u043e \u043f\u043e\u0448\u043b\u043e \u043d\u0435 \u0442\u0430\u043a: ".concat(e.status))}))}}]),e}())({url:"https://mesto.nomoreparties.co/v1/cohort-17",headers:{authorization:"159d2343-af0f-47ed-9479-4499ffedf0da","Content-Type":"application/json"}});function T(e){return Object(a.jsx)(v,{name:"apply-delete",title:"\u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b?",submitText:e.submitText,onClose:e.onClose,isOpen:e.isOpen,onSubmit:function(t){t.preventDefault(),e.onDeleteCard(e.cardId)}})}var S=function(){var e=s.a.useState({}),t=Object(u.a)(e,2),n=t[0],c=t[1],r=s.a.useState(!1),o=Object(u.a)(r,2),l=o[0],f=o[1],h=s.a.useState(!1),_=Object(u.a)(h,2),b=_[0],O=_[1],x=s.a.useState(!1),v=Object(u.a)(x,2),S=v[0],L=v[1],P=s.a.useState(!1),E=Object(u.a)(P,2),I=E[0],A=E[1],D=s.a.useState({isOpen:!1,cardImage:"",cardTitle:""}),U=Object(u.a)(D,2),w=U[0],J=U[1],q=s.a.useState(""),F=Object(u.a)(q,2),B=F[0],H=F[1],M=s.a.useState([]),R=Object(u.a)(M,2),z=R[0],V=R[1],G=s.a.useState(!1),K=Object(u.a)(G,2),Q=K[0],W=K[1];function X(){O(!1),A(!1),L(!1),f(!1),J({isOpen:!1,cardImage:"",cardTitle:""})}function Y(e){(e.target.classList.contains("popup")||e.target.classList.contains("popup__close-button"))&&X()}return s.a.useEffect((function(){y.getInitialCards().then((function(e){V(e)})).catch((function(e){console.log(e)}))}),[]),s.a.useEffect((function(){y.getUserInfo().then((function(e){c(e)})).catch((function(e){console.log(e)}))}),[]),Object(a.jsx)("div",{className:"App",children:Object(a.jsx)(p.Provider,{value:n,children:Object(a.jsxs)("div",{className:"page__container",children:[Object(a.jsx)(d,{}),Object(a.jsx)(j,{onEditProfile:function(e){f(!0)},onAddPlace:function(e){O(!0)},onEditAvatar:function(e){L(!0)},onCardClick:function(e){J({isOpen:!0,cardImage:e.link,cardTitle:e.name})},cards:z,onCardLike:function(e){var t=e.likes.some((function(e){return e._id===n._id}));y.changeLikeCardStatus(e._id,t).then((function(t){var n=z.map((function(n){return n._id===e._id?t:n}));V(n)})).catch((function(e){console.log(e)}))},onCardDelete:function(e){A(!0),H(e._id)}}),Object(a.jsx)(m,{}),Object(a.jsx)(k,{isOpen:l,onClose:Y,onUpdateUser:function(e){W(!0),y.setUserInfo(e).then((function(e){c(e)})).catch((function(e){console.log(e)})).finally((function(){W(!1),X()}))},submitText:Q?"\u0421\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435...":"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"}),Object(a.jsx)(C,{isOpen:S,onClose:Y,onUpdateAvatar:function(e){W(!0),y.setUserAvatar(e).then((function(e){c(e)})).catch((function(e){console.log(e)})).finally((function(){W(!1),X()}))},submitText:Q?"\u0421\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435...":"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"}),Object(a.jsx)(g,{isOpen:b,onClose:Y,onAddNewCard:function(e){W(!0),y.addNewCard(e).then((function(e){V([e].concat(Object(i.a)(z)))})).catch((function(e){console.log(e)})).finally((function(){W(!1),X()}))},submitText:Q?"\u0421\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435...":"\u0421\u043e\u0437\u0434\u0430\u0442\u044c"}),Object(a.jsx)(T,{isOpen:I,onClose:Y,onDeleteCard:function(e){W(!0),y.deleteCard(e).then((function(){var t=z.filter((function(t){return t._id!==e}));V(t)})).catch((function(e){console.log(e)})).finally((function(){W(!1),X()}))},cardId:B,submitText:Q?"\u0423\u0434\u0430\u043b\u044f\u0435\u043c...":"\u0414\u0430"}),Object(a.jsx)(N,{card:w,onClose:Y})]})})})},L=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,19)).then((function(t){var n=t.getCLS,a=t.getFID,c=t.getFCP,s=t.getLCP,r=t.getTTFB;n(e),a(e),c(e),s(e),r(e)}))};o.a.render(Object(a.jsx)(s.a.StrictMode,{children:Object(a.jsx)(S,{})}),document.getElementById("root")),L()}},[[18,1,2]]]);
//# sourceMappingURL=main.0d843604.chunk.js.map